@time @testset "attraction.jl" begin
    methane = molecule("data/methane.xyz")
    basis = parsebasis(methane, "sto-3g")
    @test isapprox(
        attraction(basis, methane),
        [-33.65274121259925 -4.192228842394927 -1.9035357921662138e-21 -8.604496082421803e-21 7.340288363670095e-21 -3.4425727440223244 -3.4423838439224324 -3.4423764359756905 -3.4424634833399463; 
         -4.192228842394927 -5.189766577822815 0.0 0.0 -3.804976047748359e-21 -4.016249422053774 -4.0161363506031185 -4.016131916245705 -4.016184021746398; 
         -1.9035357921662138e-21 0.0 -5.148220737384771 0.0 0.0 0.4246756812848189 -1.6326583425062662 -0.7572395794536849 1.9654158267787094; 
         -8.604496082421803e-21 0.0 0.0 -5.148220737384771 0.0 -1.8707161423654766 -0.5291502578272262 1.758058553822142 0.6419347261334282; 
         7.340288363670095e-21 -3.804976047748359e-21 0.0 0.0 -5.148220737384771 1.3347769462330807 -1.5861870889721597 1.3406644893969726 -1.0893213954024674; 
         -3.442572744022325 -4.016249422053775 0.42467568128481886 -1.8707161423654768 1.3347769462330807 -4.615301671438916 -2.679520234481157 -2.6794750152412474 -2.6796318189249444; 
         -3.4423838439224324 -4.016136350603119 -1.6326583425062662 -0.5291502578272262 -1.5861870889721597 -2.679520234481157 -4.615179581043385 -2.6794529041385102 -2.6794686251957405; 
         -3.4423764359756905 -4.016131916245705 -0.7572395794536848 1.758058553822142 1.3406644893969728 -2.6794750152412474 -2.6794529041385102 -4.615174793064606 -2.679549806733299; 
         -3.4424634833399463 -4.016184021746398 1.9654158267787092 0.6419347261334281 -1.0893213954024672 -2.679631818924944 -2.6794686251957414 -2.679549806733299 -4.6152310541286266;;; 
         -0.9107389700390929 -0.22580942460504855 0.010708951701815864 -0.04717343068901394 0.03365877181067185 -0.1992626341992148 -0.1695204461049575 -0.16951942094126693 -0.16952544188564547; 
         -0.22580942460504855 -0.710198636460394 0.053864646571991734 -0.23727627525122025 0.16929928326427446 -0.762592005840716 -0.4940870573877026 -0.4940817160351675 -0.49410108689463494; 
         0.010708951701815864 0.053864646571991734 -0.6384476068920824 0.034151805775892316 -0.024367696407563783 0.14209302263142265 -0.16935887312313258 -0.06271002512984689 0.2689844239978512; 
         -0.04717343068901393 -0.23727627525122025 0.034151805775892316 -0.7811350189780559 0.1073408368569099 -0.6259263783362949 -0.19459499736334632 0.08404740714505837 -0.051931998306689035; 
         0.03365877181067185 0.16929928326427446 -0.024367696407563783 0.1073408368569099 -0.7072836158004974 0.4466054902300766 -0.10038900166383986 0.25617425453786385 -0.03985486413725883; 
         -0.1992626341992148 -0.762592005840716 0.14209302263142265 -0.625926378336295 0.4466054902300766 -1.226613730386727 -0.4318888290724372 -0.43187655167623135 -0.4319157019514332; 
         -0.16952044610495748 -0.49408705738770253 -0.1693588731231326 -0.19459499736334632 -0.10038900166383986 -0.4318888290724372 -0.5367469357409668 -0.30331064865373913 -0.3033186827265418; 
         -0.1695194209412669 -0.4940817160351675 -0.0627100251298469 0.08404740714505839 0.25617425453786385 -0.4318765516762314 -0.30331064865373913 -0.536738498622989 -0.30332610574339314; 
         -0.16952544188564547 -0.49410108689463483 0.2689844239978512 -0.05193199830668904 -0.03985486413725884 -0.43191570195143314 -0.3033186827265418 -0.30332610574339314 -0.5367654030672256;;; 
         -0.9106990016723367 -0.22579968732433747 -0.04116693680541234 -0.013342347665404139 -0.03999517961182208 -0.16952242851993415 -0.19924275410625156 -0.1695134560356092 -0.16951720727061076; 
         -0.2257996873243375 -0.7101856131654215 -0.2070791963417735 -0.06711508910473943 -0.2011849871344355 -0.49409049733381905 -0.7625733941513326 -0.49407998071034276 -0.4940830064971323; 
         -0.04116693680541235 -0.2070791963417735 -0.7452693679468136 -0.0371381007733181 -0.1113256113631495 -0.06183818567080446 -0.5462715917002257 -0.20582071877990768 0.125862843269897; 
         -0.01334234766540414 -0.06711508910473943 -0.0371381007733181 -0.6427187867545363 -0.03608101855845449 -0.26470623263274073 -0.17704852636108354 0.1773658692300009 0.04139398117361094; 
         -0.03999517961182208 -0.20118498713443553 -0.1113256113631495 -0.03608101855845449 -0.7388390880637756 0.05226598128505455 -0.5307227625450628 0.05298782809826005 -0.24304343386590208; 
         -0.16952242851993415 -0.49409049733381916 -0.06183818567080446 -0.26470623263274073 0.05226598128505456 -0.5367469357409668 -0.4318888290724372 -0.30330969042650224 -0.3033264784268521; 
         -0.19924275410625159 -0.7625733941513326 -0.5462715917002257 -0.17704852636108354 -0.5307227625450629 -0.4318888290724372 -1.226613730386727 -0.43188088576208267 -0.4318804410276442; 
         -0.1695134560356092 -0.49407998071034276 -0.2058207187799077 0.1773658692300009 0.05298782809826004 -0.30330969042650224 -0.4318808857620826 -0.5367414770362707 -0.30331960769563016; 
         -0.16951720727061076 -0.4940830064971323 0.12586284326989702 0.04139398117361095 -0.24304343386590208 -0.30332647842685223 -0.4318804410276442 -0.30331960769563016 -0.536741171411601;;; 
         -0.9106974342921645 -0.22579930547039406 -0.019093481377195187 0.04432871599453269 0.03380429807939489 -0.1695214811269508 -0.1695135337829354 -0.19924197450751716 -0.1695182931644354; 
         -0.225799305470394 -0.7101851024232579 -0.09604488884081613 0.22298430108383044 0.17004390070294442 -0.49408529090526837 -0.49408011561764076 -0.7625726642415308 -0.4940924441378091; 
         -0.019093481377195187 -0.09604488884081613 -0.655331420207939 0.057228437585713714 0.04364139856891216 -0.0009403390460100392 -0.25157236785582415 -0.2533649464707604 0.1867605326906285; 
         0.04432871599453269 0.22298430108383038 0.057228437585713714 -0.7635471137249074 -0.10132081858450992 -0.1056002456476745 0.05783024788121379 0.5882291727315258 0.200502911862896; 
         0.03380429807939489 0.17004390070294442 0.04364139856891216 -0.10132081858450992 -0.7079471793938792 0.25586492364287927 -0.09997718512467237 0.44857320695832575 -0.03944410264901229; 
         -0.1695214811269508 -0.49408529090526837 -0.0009403390460100388 -0.10560024564767449 0.2558649236428793 -0.536738498622989 -0.3033124048406829 -0.4318765516762314 -0.3033287728214003; 
         -0.1695135337829354 -0.49408011561764076 -0.25157236785582415 0.05783024788121379 -0.09997718512467235 -0.3033124048406829 -0.5367414770362707 -0.4318808857620826 -0.30331447905621833; 
         -0.19924197450751716 -0.7625726642415308 -0.2533649464707604 0.5882291727315258 0.44857320695832575 -0.43187655167623135 -0.43188088576208267 -1.226613730386727 -0.4319036383007688; 
         -0.1695182931644354 -0.4940924441378092 0.18676053269062853 0.20050291186289604 -0.0394441026490123 -0.3033287728214003 -0.30331447905621833 -0.4319036383007688 -0.5367571127848217;;; 
         -0.9107158519861728 -0.2258037924853615 0.04955905368484011 0.016186741309981156 -0.027467845114119052 -0.16952658847082178 -0.16951637146336565 -0.16951737962990937 -0.19925113532336391;
         -0.2258037924853615 -0.7101911038337247 0.24928596442078954 0.08142059055342322 -0.13816543599436426 -0.4941030765231586 -0.4940815561956361 -0.4940908589433223 -0.7625812409327457; 
         0.0495590536848401 0.24928596442078954 -0.7967438488575027 -0.05423653778050866 0.09203587002174757 0.18846339078513735 -0.06218103755893579 0.044470218560588956 0.657610320153276; 
         0.01618674130998116 0.08142059055342322 -0.05423653778050866 -0.6484019586933308 0.030060316097940125 -0.18324457426217097 -0.01980969357212541 0.25883410788534683 0.21478554055504676; 
         -0.027467845114119052 -0.13816543599436426 0.09203587002174757 0.030060316097940125 -0.6816978772674015 0.0868302256967651 -0.2690114869177273 0.08755119580543272 -0.3644770647616675; 
         -0.16952658847082178 -0.49410307652315866 0.18846339078513735 -0.18324457426217097 0.08683022569676511 -0.5367654030672256 -0.3033205372234131 -0.30332011725024777 -0.43191570195143314; 
         -0.16951637146336568 -0.4940815561956361 -0.06218103755893579 -0.01980969357212541 -0.2690114869177273 -0.3033205372234131 -0.5367411714116012 -0.30331457738242956 -0.4318804410276442; 
         -0.16951737962990937 -0.4940908589433223 0.044470218560588956 0.25883410788534683 0.08755119580543272 -0.30332011725024777 -0.30331457738242956 -0.5367571127848217 -0.4319036383007688; 
         -0.19925113532336391 -0.7625812409327457 0.6576103201532759 0.2147855405550468 -0.3644770647616675 -0.4319157019514332 -0.4318804410276442 -0.4319036383007688 -1.226613730386727],
        atol = 1e-3,
    )
end
